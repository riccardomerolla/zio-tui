version = "3.9.10"
runner.dialect = scala3
maxColumn = 120

# Alignment helps readability in ZIO compositions
align {
  preset = most
  stripMargin = true
  multiline = true
}

assumeStandardLibraryStripMargin = false

binPack {
  literalArgumentLists = false
}

continuationIndent {
  defnSite = 2
  callSite = 2
  extendSite = 2
  withSiteRelativeToExtends = 3
}

includeNoParensInSelectChains = true

# Your custom indentation
indent {
  caseSite = 5
}

indentOperator {
  topLevelOnly = false
}

newlines {
  alwaysBeforeElseAfterCurlyIf = true
  avoidInResultType = true
  beforeCurlyLambdaParams = multilineWithCaseOnly
  # ZIO Specific: Prevents breaking long chains of .map/.flatMap weirdly
  source = keep 
}

project {
  excludeFilters = [
    ".metals"
  ]
}

rewrite {
  # CRITICAL CHANGE: Removed 'Imports' from here.
  # We let Scalafix 'OrganizeImports' handle the grouping and sorting.
  rules = [
    PreferCurlyFors
    RedundantBraces
    RedundantParens
    SortModifiers
  ]
  
  sortModifiers {
    order = [
      final
      sealed
      abstract
      override
      implicit
      private
      protected
      lazy
    ]
  }

  scala3 {
    convertToNewSyntax = true # Optional: standardizes syntax
    removeOptionalBraces = false # Keep false for ZIO chain readability
  }
}

rewriteTokens {
  "⇒" = "=>"
  "→" = "->"
  "←" = "<-"
}

spaces {
  inImportCurlyBraces = true
}

trailingCommas = multiple

danglingParentheses.exclude = []

# Excellent for ZIO Service definitions with many dependencies
verticalMultiline {
  arityThreshold = 7
  atDefnSite = true
  newlineAfterOpenParen = true
}