rules = [
  # Semantic Rules (Require compilation)
  OrganizeImports,
  RemoveUnused,
  ExplicitResultTypes,
  
  # Syntactic Rules (Format & Hygiene)
  DisableSyntax,
  LeakingImplicitClassVal,
  NoValInForComprehension,
  ProcedureSyntax,
  RedundantSyntax
]

# --- ZIO & Beautiful Code Configuration ---

OrganizeImports {
  # Group imports to separate Java, Scala, and ZIO dependencies clearly
  groups = [
    "re:javax?\\.",   # Java standard libs
    "scala.",         # Scala standard libs
    "zio.",           # ZIO core and ecosystem
    "*"               # Everything else (libraries, domain code)
  ]
  removeUnused = true
  coalesceToWildcardImportThreshold = 5 # Avoids wildcard imports unless 5+ items
  expandRelative = true                 # Fixes relative imports for better refactoring safety
  groupedImports = Merge                # Merges multiple imports from same package
  importSelectorsOrder = Ascii
  importsOrder = Ascii
  preset = DEFAULT
  targetDialect = Scala3                # CRITICAL: Use Scala 3 wildcard syntax (.*) instead of Scala 2 (._)
}

DisableSyntax {
  noVars = true                # Use Ref for mutable state in ZIO
  noThrows = true              # Use ZIO.fail instead of throw
  noNulls = true               # Use Option for null safety
  noReturns = true             # Breaking referential transparency
  noWhileLoops = true          # Use recursion or ZStream
  noFinalize = true            # Garbage collection best practice
  noValPatterns = true         # Prevents pattern matching in val assignment
  
  # Ban println to enforce using ZIO Console or logging
  # Allows println as a method name (e.g., terminal.println) but disallows Predef.println
  regex = [
    {
      id = "noPrintln"
      pattern = "^(scala\\.)?Predef\\.println|^println\\("
      message = "Avoid println. Use ZIO.log or Console.printLine for effectful logging."
    }
  ]
}

ExplicitResultTypes {
  # Essential for ZIO to prevent type inference from leaking internal implementation details
  memberVisibility = [Public, Protected]
  skipSimpleDefinitions = true
}

RemoveUnused {
  imports = true
  privates = true
  locals = true
  patternvars = true
}